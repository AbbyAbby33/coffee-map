(this["webpackJsonpreact-leaflet-map"]=this["webpackJsonpreact-leaflet-map"]||[]).push([[0],{48:function(e,t,a){e.exports=a(84)},63:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){},83:function(e,t,a){},84:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(11),l=a(14),o=a(20),i=a(44),s=a(45),u=a(10),m=a.n(u),d=a(15),p=a(17),h=a(30),f=a(31),E=a(29),b=a(32),g=a(46),y=a.n(g);function k(e){switch(e){case 5:return"\u2605\u2605\u2605\u2605\u2605";case 4:return"\u2605\u2605\u2605\u2605";case 3:return"\u2605\u2605\u2605";case 2:return"\u2605\u2605";default:return"\u2605"}}const v=e=>c.a.createElement(h.a,Object.assign({ref:e=>{e&&e.leafletElement.openPopup()}},e));var O=function({isMenuOpen:e,toggleMenu:t,item:a,items:n}){const r=a.latitude,l=a.longitude,o=a.url,i=a.name,s=a.address,u=a.wifi,m=a.seat,d=a.quiet,p=a.tasty,g=a.cheap,O=a.music,w=[parseFloat(r),parseFloat(l)],N=!!o;let _=null;const C=n.filter(e=>e.lat).map((e,t)=>c.a.createElement(h.a,{key:"".concat(e.lat).concat(e.lng).concat(t),opacity:.6,position:[parseFloat(e.lat),parseFloat(e.lng)]},c.a.createElement(f.a,null,c.a.createElement("div",{dangerouslySetInnerHTML:{__html:e.popup}}))));return r&&(_=c.a.createElement("button",{type:"button"},c.a.createElement(v,{position:w},c.a.createElement(f.a,{autoPan:!0},c.a.createElement("div",null,c.a.createElement("span",{style:{fontWeight:800,fontSize:"16px"}},i),c.a.createElement("br",null),c.a.createElement("span",null,s,c.a.createElement("br",null),u>0?"WIFI\u7a69\u5b9a: ".concat(k(u)," "):" ",u>0?c.a.createElement("br",null):"",m>0?"\u901a\u5e38\u6709\u4f4d:  ".concat(k(m)," "):" ",m>0?c.a.createElement("br",null):"",d>0?"\u5b89\u975c\u7a0b\u5ea6:  ".concat(k(d)," "):" ",d>0?c.a.createElement("br",null):"",p>0?"\u5496\u5561\u597d\u559d:  ".concat(k(p)," "):" ",p>0?c.a.createElement("br",null):"",g>0?"\u50f9\u683c\u4fbf\u5b9c:  ".concat(k(g)," "):" ",g>0?c.a.createElement("br",null):"",O>0?"\u88dd\u6f62\u97f3\u6a02:  ".concat(k(O)," "):" ",O>0?c.a.createElement("br",null):""),N?c.a.createElement("a",{href:o},"\u7c89\u7d72\u5c08\u9801"):""))))),c.a.createElement(E.a,{center:r?w:[24.8,121.023],zoom:12,maxZoom:18,zoomControl:!1,animate:!0,onClick:()=>{e&&t()}},c.a.createElement(b.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),r&&_,c.a.createElement(y.a,null,C))};a(63);var w=e=>c.a.createElement("button",{type:"button",id:"menu-button",onClick:t=>{const a=e.toggleMenu;t.preventDefault(),a()}},c.a.createElement("div",{className:"hamburger"},c.a.createElement("div",{className:"inner"})));a(64);const N=e=>({type:"TOGGLE_CONDITION",payload:e}),_=[{name:"taipei",displayName:"\u53f0\u5317",checked:!1},{name:"keelung",displayName:"\u57fa\u9686",checked:!1},{name:"taoyuan",displayName:"\u6843\u5712",checked:!1},{name:"hsinchu",displayName:"\u65b0\u7af9",checked:!0},{name:"miaoli",displayName:"\u82d7\u6817",checked:!1},{name:"taichung",displayName:"\u53f0\u4e2d",checked:!1},{name:"changhua",displayName:"\u5f70\u5316",checked:!1},{name:"nantou",displayName:"\u5357\u6295",checked:!1},{name:"yunlin",displayName:"\u96f2\u6797",checked:!1},{name:"chiayi",displayName:"\u5609\u7fa9",checked:!1},{name:"tainan",displayName:"\u53f0\u5357",checked:!1},{name:"kaohsiung",displayName:"\u9ad8\u96c4",checked:!1},{name:"pingtung",displayName:"\u5c4f\u6771",checked:!1},{name:"yilan",displayName:"\u5b9c\u862d",checked:!1},{name:"hualien",displayName:"\u82b1\u84ee",checked:!1},{name:"taitung",displayName:"\u53f0\u6771",checked:!1},{name:"penghu",displayName:"\u6f8e\u6e56",checked:!1}],C=[{name:"socket",displayName:"\u63d2\u5ea7",checked:!1},{name:"quiet",displayName:"\u5b89\u975c",checked:!1},{name:"wifi",displayName:"\u7db2\u8def",checked:!1}];var j=Object(o.b)((function(e){return{checkedCities:e.checkedCities,checkedConditions:e.checkedConditions}}))((function({checkedCities:e,checkedConditions:t,dispatch:a,toggleMenu:n}){const r=_.map((t,r)=>c.a.createElement("li",{className:"nav__li",key:t.name},c.a.createElement("input",{id:t.name,type:"checkbox",checked:e[r],onChange:()=>{const t=e.slice();t[r]=!e[r],a((e=>({type:"TOGGLE_CHECK",payload:e}))(t)),n()}}),c.a.createElement("label",{htmlFor:t.name,className:"nav__label"},t.displayName))),l=C.map((e,r)=>c.a.createElement("li",{className:"nav__li",key:e.name},c.a.createElement("input",{id:e.name,type:"checkbox",checked:t[r],onChange:()=>{const e=t.slice();e[r]=!t[r],a(N(e)),n()}}),c.a.createElement("label",{htmlFor:e.name,className:"nav__label nav__label--condition"},e.displayName)));return c.a.createElement("nav",null,c.a.createElement("ul",null,l,c.a.createElement("br",null),r))})),S=(a(65),a(26)),M=a(47),x=a.n(M);const L=(0,window.lunr)((function(){this.field("name"),this.field("address"),this.field("strSocket"),this.field("quietAways"),this.field("wifiGood")})),G=_.map(e=>e.coffeeShops?e:Object(S.a)({},e,{coffeeShops:[]})),I=function(){var e=Object(d.a)(m.a.mark((function e(t){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.get("".concat("/coffee-map","/cafedata/").concat(t.name,".json"));case 2:if(!(a=e.sent).data){e.next=8;break}return a.data.forEach(e=>{L.add(Object(S.a)({},e,{strSocket:e&&"yes"===e.socket?"\u63d2\u5ea7":"",quietAways:e&&e.quiet>3?"\u5b89\u975c":"",wifiGood:e&&e.wifi>3?"\u7db2\u8def":""}))}),t.coffeeShops=a.data,t.checked=!0,e.abrupt("return",t);case 8:return e.abrupt("return",t);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function T(){return(T=Object(d.a)(m.a.mark((function e(t){var a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map((e,t)=>{if(e&&!G[t].coffeeShops.length){return I(G[t])}return e||(G[t].checked=!1),e&&(G[t].checked=!0),G[t]}));case 2:return a=e.sent,n=[],a.forEach(e=>{e.checked&&(n=n.concat(e.coffeeShops))}),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(){return(F=Object(d.a)(m.a.mark((function e(t){var a,n,c,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],""===t.toString().trim()){e.next=7;break}return console.log(t),e.next=5,L.search(t);case 5:(n=e.sent)&&n.length&&(c=n.map(e=>e.ref),r=[],G.filter(e=>e.checked).forEach(e=>{r=r.concat(e.coffeeShops)}),r=r.filter(e=>-1!==c.indexOf(e.id)),a=r);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var D={getCoffee:function(e){return T.apply(this,arguments)},searchWithKeyWord:function(e){return F.apply(this,arguments)}};var P=function({onChange:e,onHover:t,checkedConditions:a,nowItem:r,toggleCondition:l}){let o="";const i=Object(n.useRef)(null),s=Object(n.useState)([]),u=Object(p.a)(s,2),h=u[0],f=u[1],E=Object(n.useState)(""),b=Object(p.a)(E,2),g=b[0],y=b[1],k=C.filter((e,t)=>a[t]).map(e=>e.displayName).join(" "),v=Object(n.useCallback)(function(){var e=Object(d.a)(m.a.mark((function e(t){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&t.preventDefault(),e.next=3,D.searchWithKeyWord("".concat(k," ").concat(g));case 3:a=e.sent,f(a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[k,g]);function O(e){e&&r&&e.id!==r.id&&(t(e),i.current.blur())}Object(n.useEffect)(()=>{""===g&&v()},[g,v]),Object(n.useEffect)(()=>{""!==k&&v()},[k,v]),h.length&&(o=h.map(t=>c.a.createElement("div",{role:"presentation",key:t.id,className:"card",onClick:()=>{f([]),e(t),i.current.blur()},onFocus:()=>{O(t)},onMouseOver:()=>{O(t)},onTouchMove:()=>{O(t)},onPointerOver:()=>{O(t)}},c.a.createElement("h4",null,t.name),c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement("ol",null,"no"===t.limited_time?c.a.createElement("li",null,"\u7121\u9650\u6642"):"",""!==t.socket||"no"!==t.socket?c.a.createElement("li",null,"\u63d2\u5ea7"):"",t.wifi>3?c.a.createElement("li",null,"WIFI"):"",t.quiet>3?c.a.createElement("li",null,"\u8f03\u5b89\u975c"):"",t.cheap>3?c.a.createElement("li",null,"\u8f03\u4fbf\u5b9c"):"")),c.a.createElement("li",null,"\u5730\u5740:".concat(t.address)),t.open_time?c.a.createElement("li",null,"\u71df\u696d\u6642\u9593: ".concat(t.open_time)):"",c.a.createElement("li",null,c.a.createElement("a",{href:t.url},"\u7c89\u7d72\u5c08\u9801"))))));let w="\u8f38\u5165\u5e97\u540d \u5730\u5740";k&&(w="\u67e5\u8a62\u689d\u4ef6:".concat(k));let N=c.a.createElement("button",{type:"submit",className:"btn search__button",onClick:v},c.a.createElement("svg",{viewBox:"0 0 100 100"},c.a.createElement("circle",{id:"circle",cx:"45",cy:"45",r:"30"}),c.a.createElement("path",{id:"line",d:"M45,45 L100,100"})));return""===g&&""===k||(N=c.a.createElement("button",{type:"button",className:"btn search__button",onClick:function(){l(),y("")}},c.a.createElement("span",null,"\u2715"))),c.a.createElement("form",{onSubmit:v},c.a.createElement("input",{value:g,onChange:function(e){y(e.target.value)},ref:i,onClick:()=>{v()},onKeyPress:function(e){"Enter"===e.key&&i.current.blur()},placeholder:"".concat(w)}),c.a.createElement("div",{className:"search__result"},o),N)};function q({isMenuOpen:e,checkedCities:t,checkedConditions:a,toggleMenu:r,toggleCondition:l}){const o=Object(n.useState)({name:"\u641c\u5c0b\u60f3\u53bb\u7684\u5496\u5561\u5e97~",address:"\u986f\u793a\u5730\u5740\u53ca\u7c89\u5c08"}),i=Object(p.a)(o,2),s=i[0],u=i[1],h=Object(n.useState)([]),f=Object(p.a)(h,2),E=f[0],b=f[1],g=Object(n.useState)(!0),y=Object(p.a)(g,2),k=y[0],v=y[1],N=s;let _=E;const C=e?"menu-open":"";let S="";function M(e){switch(e){case 5:return"\u2605\u2605\u2605\u2605\u2605";case 4:return"\u2605\u2605\u2605\u2605";case 3:return"\u2605\u2605\u2605";case 2:return"\u2605\u2605";default:return"\u2605"}}function x(){return(x=Object(d.a)(m.a.mark((function e(t){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(!0),console.log("loading"),e.next=4,D.getCoffee(t);case 4:a=e.sent,console.log("loading done"),v(!1),b(a);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)(()=>{!function(e){x.apply(this,arguments)}(t)},[t]),_=0===E.length?[{lat:24.8,lng:121.023,popup:"<div><span>\u76ee\u524d\u5c1a\u672a\u9078\u64c7\u4efb\u4f55\u5730\u9ede<br/>\u8acb\u6309\u5de6\u65b9\u529f\u80fd\u9375\u9032\u5165\u9078\u55ae\u9078\u64c7XD<br/></span></div>"}]:E.map(e=>{const t=e.latitude,a=e.longitude,n=e.name,c=e.address,r=e.wifi,l=e.seat,o=e.quiet,i=e.tasty,u=e.cheap,m=e.music;return{lat:parseFloat(t),lng:parseFloat(a),popup:"<div>\n            <span style=".concat({fontWeight:800,fontSize:"16px"},">").concat(n,"</span><br /> \n            <span>\n            ").concat(c,"<br />\n            ").concat(r>0?"WIFI\u7a69\u5b9a: ".concat(M(r)):""," ").concat(r>0?"<br />":"","\n            ").concat(l>0?"\u901a\u5e38\u6709\u4f4d:  ".concat(M(l)):""," ").concat(l>0?"<br />":"","\n            ").concat(o>0?"\u5b89\u975c\u7a0b\u5ea6:  ".concat(M(o)):""," ").concat(o>0?"<br />":"","\n            ").concat(i>0?"\u5496\u5561\u597d\u559d:  ".concat(M(i)):""," ").concat(i>0?"<br />":"","\n            ").concat(u>0?"\u50f9\u683c\u4fbf\u5b9c:  ".concat(M(u)):""," ").concat(u>0?"<br />":"","\n            ").concat(m>0?"\u88dd\u6f62\u97f3\u6a02:  ".concat(M(m)):""," ").concat(m>0?"<br />":"","\n            </span>\n            ").concat(s.url?"<a href=".concat(s.url,">\u7c89\u7d72\u5c08\u9801</a>"):"","\n          </div>")}}),k&&(S=c.a.createElement("div",{className:"loading__overlay"},c.a.createElement("div",{className:"loading__content"},c.a.createElement("div",{className:"loader"},"Loading...")))),c.a.createElement("div",{className:"app"},S,c.a.createElement("div",{className:C},c.a.createElement("div",{className:"search-container"},c.a.createElement(P,{nowItem:s,toggleCondition:l,checkedConditions:a,onChange:function(e){s&&e&&s.id!==e.id&&u(e),l()},onHover:function(e){s&&e&&s.id!==e.id&&u(e)}})),c.a.createElement(j,{toggleMenu:r}),c.a.createElement(w,{toggleMenu:r})),c.a.createElement(O,{item:N,items:_,isMenuOpen:e,toggleMenu:r}))}q.defaultProps={name:"Gary"};var W=Object(o.b)((function(e){return{isMenuOpen:e.isMenuOpen,checkedCities:e.checkedCities,checkedConditions:e.checkedConditions}}),e=>({toggleCondition:()=>e(N()),toggleMenu:()=>e({type:"TOGGLE_MENU"})}))(q);a(83);var A=(e=!1,t)=>{switch(t.type){case"TOGGLE_MENU":return!e;default:return e}};var z=(e={name:"\u641c\u5c0b\u60f3\u53bb\u7684\u5496\u5561\u5e97~",address:"\u986f\u793a\u5730\u5740\u53ca\u7c89\u5c08"},t)=>{switch(t.type){case"SELECT_PLACE":return{name:"\u641c\u5c0b\u60f3\u53bb\u7684\u5496\u5561\u5e97~1",address:"\u986f\u793a\u5730\u5740\u53ca\u7c89\u5c08"};default:return e}};var H=(e=[],t)=>{switch(t.type){case"ALL_PLACE":return[...e];default:return e}};const K=_.map(e=>e.checked);var U=(e=K,t)=>{switch(t.type){case"TOGGLE_CHECK":return[...t.payload];default:return e}};const X=C.map(e=>e.checked);var B=(e=X,t)=>{switch(t.type){case"TOGGLE_CONDITION":return t.payload?[...t.payload]:X;default:return e}};var R=Object(l.c)({checkedCities:U,checkedConditions:B,isMenuOpen:A,item:z,items:H});Object(i.createLogger)();const J=[s.a],V=("object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):l.d)(Object(l.a)(...J)),Z=Object(l.e)(R,V);Object(r.render)(c.a.createElement(o.a,{store:Z},c.a.createElement(W,null)),document.getElementById("root"));var Q,Y,$,ee,te,ae;if("linyencheng.github.io"===window.location.host&&(Q=window,Y=document,$="script",ee="ga",Q.GoogleAnalyticsObject=ee,Q.ga=Q.ga||function(){(Q.ga.q=Q.ga.q||[]).push(arguments)},Q.ga.l=1*new Date,te=Y.createElement($),ae=Y.getElementsByTagName($)[0],te.async=1,te.src="//www.google-analytics.com/analytics.js",ae.parentNode.insertBefore(te,ae),window.ga)){const e=window.ga;e("create","UA-106834789-1","linyencheng.github.io"),e("send","pageview")}}},[[48,1,2]]]);
//# sourceMappingURL=main.0d7373ab.chunk.js.map